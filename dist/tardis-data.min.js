(function(){function l(b,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,a):b.__proto__=a)}function g(b,a){if(!(b instanceof a))throw new TypeError("Cannot call a class as a function");}var p=function(b,a,d){var c=!0;for(;c;)if(null===b&&(b=Function.prototype),c=Object.getOwnPropertyDescriptor(b,
a),void 0===c){b=Object.getPrototypeOf(b);if(null===b)break;c=!0}else{if("value"in c)return c.value;a=c.get;return void 0===a?void 0:a.call(d)}},h=function(){function b(a,d){for(var c=0;c<d.length;c++){var b=d[c];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}return function(a,d,c){d&&b(a.prototype,d);c&&b(a,c);return a}}(),r=function(){function b(a,d,c,e){g(this,b);this.id=a;this.name=d;this.namespace=c;this.isHidden=e;this.parameters=
[]}h(b,[{key:"addParameter",value:function(a){if(!(a instanceof q))throw new TypeError("parameter must be an instance of Parameter");a._setParent(this);this.parameters.push(a)}},{key:"getParameters",value:function(){this.parameters.sort(function(a,d){var c=a.order?parseInt(a.order):9999,b=d.order?parseInt(d.order):9999;return c-b});return this.parameters}}]);return b}(),q=function(){function b(a,d,c,e,t,k,u,f){g(this,b);this.parent=null;this.id=a;this.name=d;this.fullName=c;this.value=e;this.units=
t;this.order=k;this.isImmutable=u;this.isSearchable=f}h(b,[{key:"_setParent",value:function(a){if(!(a instanceof r))throw new TypeError("Parent must be a ParameterSet");this.parent=a}}]);return b}(),v=function(b){function a(d,c,b){g(this,a);p(Object.getPrototypeOf(a.prototype),"constructor",this).call(this,d,c,b,function(a){a.setBaseUrl(c+b);a.addResponseInterceptor(function(a,d,b,c,e){"getList"===d?(d=a.objects,d.meta=a.meta):d=e.data;return d});a.setRequestSuffix("/")})}l(a,b);h(a,[{key:"getList",
value:function(a,b){var e=this;return this._getList(a,b).then(function(a){null!==a.meta.next&&(a.getNextPage=function(){return e._getListFromUrl(e.baseUrl+a.meta.next,a.route)});null!==a.meta.previous&&(a.getPreviousPage=function(){return e._getListFromUrl(e.baseUrl+a.meta.previous,a.route)});return a})}},{key:"getExperiments",value:function(a){return this.getList("experiment",a)}},{key:"getExperiment",value:function(a){return this.restangular.one("experiment",a).get()}},{key:"getDatasets",value:function(a){var b=
{};a.hasOwnProperty("id")?b.experiments__id=a.id:"number"===typeof a?b.experiments__id=a:b=a;return this.getList("dataset",b)}},{key:"getDataset",value:function(a){return this.restangular.one("dataset",a).get()}},{key:"getDatafiles",value:function(a){var b={};a.hasOwnProperty("id")?b.dataset__id=a.id:"number"===typeof a?b.dataset__id=a:b=a;return this.getList("dataset_file",b)}},{key:"getDatafile",value:function(a){return this.restangular.one("dataset_file",a).get()}},{key:"getParameterSets",value:function(a){function b(a,
d){return e.restangular.oneUrl("parametername",e.baseUrl+a.name).get().then(function(b){return{id:a.id,name:b.name,fullName:b.full_name,value:a.numerical_value||a.datetime_value||a.string_value||a.value||a.link_id,units:b.units,order:b.order,isImmutable:b.immutable,isSearchable:b.is_searchable}}).then(function(a){d.addParameter(new q(a.id,a.name,a.fullName,a.value,a.units,a.order,a.isImmutable,a.isSearchable))})}if(!a.hasOwnProperty("parameter_sets"))throw new TypeError("Object must have a 'parameter_sets' property");
var e=this,g=[],k;a=a.parameter_sets;for(var h in a)if(a.hasOwnProperty(h)){var f=a[h],m=new r(f.id,f.schema.name,f.schema.namespace,f.schema.hidden),f=f.parameters,n;for(n in f)if(f.hasOwnProperty(n)){var l=f[n];k?function(a,d){k=k.then(function(){b(a,d)})}(l,m):k=b(l,m)}g.push(m)}return k.then(function(){return g})}}]);return a}(function(){function b(a,d,c,e){g(this,b);a=a.get("Restangular");this.baseUrl=d;this.baseUri=c;this.restangular=e?a.withConfig(e):a}h(b,[{key:"_getListFromUrl",value:function(a,
b,c){c=c||{};return this.restangular.allUrl(b,a).getList(c)}},{key:"_getList",value:function(a,b){b=b||{};return this.restangular.all(a).getList(b)}}]);return b}());angular.module("tardis-data",["restangular"]).provider("tardisData",function(){function b(b){switch(a){case 1:return new v(b,d,c);default:throw new w(a);}}var a=1,d="",c="/api/v1/";b.$inject=["$injector"];return{setApiVersion:function(b){a=b},setApiBaseUrl:function(a){d=a},setApiBaseUri:function(a){c=a},$get:b}});var w=function(b){function a(b){g(this,
a);p(Object.getPrototypeOf(a.prototype),"constructor",this).call(this,"Unsupported API version requested: "+b)}l(a,b);return a}(Error)})();
